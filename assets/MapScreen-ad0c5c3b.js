var u=Object.defineProperty;var P=(A,o,e)=>o in A?u(A,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):A[o]=e;var _=(A,o,e)=>(P(A,typeof o!="symbol"?o+"":o,e),e);import{a as D,c as V}from"./Library-3fb43614.js";import{d as v,r as i,_ as j,c,a as s,b as G,w as r,F as M,e as y,f as n,o as g,g as a,t as E}from"./index-bbcc5f0a.js";const K={}.APP_KEY;class N{constructor(){_(this,"URL","https://api.calil.jp/library?appkey={appKey}&geocode={geocode}&format=json&callback=")}async getLiblaries(o){return(await D.get(this.URL.replace("{geocode}",o).replace("{appKey}",K))).data}}const Y=new N,O="/library_rader/assets/pin-66c3ed51.png",q=v({name:"MapScreen",setup(A){const o=i(Array()),e=i(!0),B=i(!0),l=i([139.7673068,35.6809591]),I=i("EPSG:4326"),C=i(14.5),Q=i(0),d=i([0]),w=localStorage.getItem("favorite_libralies")??"[]",p=i(JSON.parse(w));return{showMap:e,libraries:o,favorites:p,center:l,projection:I,zoom:C,rotation:Q,isLoading:B,coordinate:d,markerIcon:O,calilUrl:V}},mounted(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(A=>{this.center=[A.coords.longitude,A.coords.latitude],Y.getLiblaries(`${this.center[0]},${this.center[1]}`).then(e=>{this.libraries=e,console.log(this.libraries),this.coordinate=e.flatMap(B=>{const l=B.geocode.split(",");return[Number(l[0]),Number(l[1])]})}),this.isLoading=!1},A=>{alert("位置情報の取得に失敗しました。"),this.isLoading=!1})},methods:{onClickList(){this.showMap=!this.showMap},onClickFavorite(A){this.favorites.push(A),localStorage.setItem("favorite_libralies",JSON.stringify(this.favorites))},onClickPoint(){console.log("onClickPoint")}}}),S="data:image/png;base64,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",T="/library_rader/assets/own-797cdd29.png",J="/library_rader/assets/favorite-eca8a2d2.png",b="/library_rader/assets/favorite_outline-5e62c9c9.png",z={class:"w-full h-full z-0"},X=s("img",{src:S},null,-1),H=[X],L=s("div",{class:"w-6 h-6"},[s("img",{src:T})],-1),W={key:1,class:"mt-4"},Z={class:"p-3"},x=["onClick"],$={key:0,class:"float-right w-8 h-8",src:J},AA={key:1,class:"float-right w-8 h-8",src:b},oA={class:"w-fit font-bold text-xs mb-2 bg-slate-200"},eA={class:"w-fit font-medium"},tA=["href"],sA={class:"w-fit text-left text-sm"},nA={class:"text-right"},aA=s("hr",{class:"mr-6"},null,-1);function iA(A,o,e,B,l,I){const C=n("ol-view"),Q=n("ol-source-osm"),d=n("ol-tile-layer"),w=n("ol-overlay"),p=n("ol-geom-multi-point"),m=n("ol-style-icon"),f=n("ol-style"),h=n("ol-feature"),F=n("ol-source-vector"),k=n("ol-vector-layer"),U=n("ol-map");return g(),c("div",z,[s("div",{onClick:o[0]||(o[0]=(...t)=>A.onClickList&&A.onClickList(...t)),class:"z-10 bottom-16 right-4 absolute w-16 h-16 bg-primary text-lg font-bold rounded-full container shadow-md shadow-gray-500 py-4 px-4"},H),A.showMap?(g(),G(U,{key:0,loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,style:{height:"100%"}},{default:r(()=>[a(C,{ref:"view",center:A.center,rotation:A.rotation,zoom:A.zoom,projection:A.projection},null,8,["center","rotation","zoom","projection"]),a(d,null,{default:r(()=>[a(Q)]),_:1}),a(w,{position:A.center},{default:r(t=>[L]),_:1},8,["position"]),a(k,null,{default:r(()=>[a(F,null,{default:r(()=>[a(h,null,{default:r(()=>[a(p,{coordinates:A.coordinate},null,8,["coordinates"]),a(f,null,{default:r(()=>[a(m,{src:A.markerIcon,scale:.1},null,8,["src","scale"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(g(),c("div",W,[(g(!0),c(M,null,y(A.libraries,t=>(g(),c("div",{key:t.libid},[s("div",Z,[s("div",{onClick:R=>A.onClickFavorite(t)},[A.favorites.map(R=>R.libid).includes(t.libid)?(g(),c("img",$)):(g(),c("img",AA))],8,x),s("p",oA,E(t.city),1),s("p",eA,[s("a",{href:A.calilUrl(t.libid,t.formal),target:"_blank"},E(t.short),9,tA)]),s("p",sA,E(t.address),1),s("p",nA,E(t.distance.toFixed(2))+"km",1)]),aA]))),128))]))])}const lA=j(q,[["render",iA]]);export{lA as default};
